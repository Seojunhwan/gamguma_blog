---
title: JS Execution Context (실행 컨텍스트) 란?
description: 코어자바스크립트를 읽고 얻은 지식 중 실행 컨텍스트, 콜스택 | JS Execution Context, JS CallStack
author: Junhwan Seo
createAt: 2022-04-09 21:53
hashTags: [JavaScript]
isPublished: false
thumbnail: /2022/02/get_next_line/images/thumbnail.png
---

## Execution Context (실행 컨텍스트) 란

실행 컨텍스트는 **실행할 코드에 제공할 환경 정보들을 모아놓은 객체**입니다.  
자바스크립트는 동일한 환경에 있는 환경 정보들을 모은 **실행 컨텍스트를** 콜스택에 쌓아올린 후 실행하여 코드의 **환경과 순서를 보장**할 수 있게 됩니다.

풀어서 설명하면 스택의 경우 FILO (First In, Last Out) 의 구조이기에 **순서를 보장**, 콜스택 내부에 쌓인 실행 컨텍스트의 정보를 통해 **환경을 보장**할 수 있는 것이라 생각합니다.

여기서 환경이란 전역공간이 될 수 있고, 함수 즉 함수 내부의 환경이 될 수 있습니다.

``` js
var temp = 'temp';

function b (){
  console.log('안녕하세용');
}

function a (){
  b();
}

a();
```

![context_example 3078x1032](/context_example.png)

> 처음 자바스크립트 코드를 실행하는 순간 사진의 (1) 처럼 전역 컨텍스트가 콜스택에 담깁니다.
> 브라우저의 경우 `window` node 환경의 경우 `global` 같은 객체를 사용할 수 있는 이유입니다. 요건 추후 스코프에 관해 포스팅 할 때 설명드릴 수 있을 것 같습니다.

- (1) 콜스택엔 전역 컨텍스트를 제외하곤 다른 컨텍스트가 없기에 전역 컨텍스트와 관련된 코드를 진행합니다.
- (2) 전역 컨텍스트와 관련된 코드를 진행 중 a함수를 실행하였기에 **a 함수의 환경 정보들을 수집**하여 **a 실행 컨텍스트를 생성**, 콜스택에 담습니다.  
콜스택 최상단에 a 실행 컨텍스트가 있기에 **기존의 전역 컨텍스트와 관련된 코드의 실행을 일시적으로 중단**한 후 a 실행 컨텍스트의 코드를 실행합니다.
- (3) a 함수 내부에서 b 함수를 실행하였기에 **b 함수의 환경 정보들을 수집, 실행 컨텍스트를 생성**, 콜스택에 담습니다.
이전과 똑같이 콜스택 최상단에 b 실행 컨텍스트가 있기에 **기존 a 실행 컨텍스트와 관련된 코드의 실행을 일시적 중단**합니다.
- (4) b 함수가 종료된 후 b 실행 컨텍스트가 콜스택에서 제거됩니다.
제거 후 콜스택 최상단에는 a 실행 컨텍스트가 있기에 이전에 중단된 지점부터 코드 진행이 재개됩니다.
- (5) a 함수 또한 종료된 후 실행 컨텍스트가 콜스택에서 제거됩니다.
- 이후엔 전역 공간에 실행할 코드가 남아있지 않다면 콜스택에서 전역 컨텍스트 또한 제거되며 콜스택에 아무 것도 남지 않은 상태로 종료됩니다.

## Execution Context (실행 컨텍스트) 속엔 어떤 정보가 있을까

우선 실행 컨텍스트 내부엔 `variable environment`, `lexical environment`, `this binding` 가 있습니다.

### VariableEnvironment

VariableEnvironment 란 현재 컨텍스트 내부의 식별자, 외부 환경 정보가 포함되어 있습니다.  
VariableEnvironment 에 먼저 정보를 담고, 그대로 LexicalEnvironment 에 복사해 사용한다고 합니다.

### LexicalEnvironment

LexicalEnvironment 는 초기에는 VariableEnvironment 와 같지만 변경 사항이 실시간으로 적용됩니다.  
즉, VariableEnvironment **초기 상태를 기억**하고 있으며, LexicalEnvironment **최신 상태를 저장**하고 있습니다.

### ThisBinding

저는 자바스크립트에서 `this` 키워드가 가장 헷갈렸습니다.  
프로그래밍 자체를 자바스크립트로 접했는데 `this` 키워드 자체를 많이 접해보지 못해서 그런 것 같습니다,,  
우선 `this` 는 컨텍스트를 가르킨다고 생각합니다.
`method` 에서 사용시 해당 `method` 가 담겨있는 `instance` or `object` 를 가르키며, 함수표현식에서 사용시 `this` 를 바인딩하지 않는 이상 **전역 객체**를 가르킵니다.

더불어 전역 공간에서 `this` 는 함수표현식과 같이 **전역 객체**를 가르킵니다.

ES6 의 화살표함수를 사용하면 `this` **바인딩**, 우회법으로 변수에 `this` 를 담아 실행할 필요 없이 함수를 실행한 컨텍스트를 바라봅니다.

```js
const obj = {
  outer: function () {
    console.log(this); // 메소드에서 사용되었기에 obj 출력
    function inner() {
      console.log(this); // 함수표현식에서 사용되었기에 전역객체 출력
    }
    inner();

    const self = this;
    function inner2() {
      console.log(self);  // 우회하기위해 this 를 self 에 할당, 출력하였기에 obj 출력
    }
    inner2();
    const inner3 = () => {
      console.log(this);  // 화살표함수 사용으로 this 는 상위 스코프의 컨텍스트를 가르킴, obj 출력
    };
    inner3();
  },
};

obj.outer();
```

> **요약**  
> `this` 란 실행 컨텍스트 생성시 즉, 함수를 실행할 때 할당해주는 것으로 상황에 따라 가끔은 전역객체, 가끔은 instance 를 가르킵니다.  
> 여튼 실행 컨텍스트에서의 `this` 에 대한 정보를 갖고 있는 것이 `ThisBinding` 입니다.
